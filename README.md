# DOSE

Optimal Exact Designs of Multiresponse Experiments under Linear and Sparsity Constraints.

## Purpose

The repository contains `R` script to generate designs and Figure 1 from the paper Optimal Exact Designs of Multiresponse Experiments under Linear and Sparsity Constraints (https://arxiv.org/abs/2507.04713). 


## Installation

To run the code, `R` with `OptimalDesign` library (https://cran.r-project.org/web/packages/OptimalDesign/index.html) and `gurobi` (https://www.gurobi.com/) is needed. For installation instructions, see the file gurobi_inst.txt in `OptimalDesign` library.

## General Guidance

The results in Section 5 of the paper can be generated by running the code in Example_5.R, as is.

However, the code can be modified to different multivariate models, criteria and constraints. In general, it is recommended to follow these steps:

1. Choose the design space, i.e., a discrete set of design points corresponding to the permissible levels of factor(s)
2. Identify (find in the literature or derive) the elementary information matrices for each design point
3. Choose the criterion of statistical estimation quality (e.g., D, A, or I-optimality) 
4. Select the required size of the experiments (the number of trials/runs)
5. Compute the optimal exact design for the required size 
6. Inspect the resulting design from the point of view of additional required limits to identify the ones that are violated
7. Sequentially add the limits while, after each step, checking for the violation of the remaining constraints until an exact design satisfying all of the required constraints is achieved.


The primary function for computing the exact design is `CRLAS`. The arguments are following:

- `x`: set of doses, or, more generally, permissible levels of the factor(s), in the  form of size-n vector 
- `N`: size of the design, i.e., the total number of the subjects available
- `A`: K*n matrix of linear constraints
- `C`: K*n matrix of sparsity constraints
- `bk`: the right-hand size of linear and sparsity constraints.
     Both types of constraints are generated jointly in the form `A*w + C*sw <= bk`,
	 where `w` is size-n design vector of number of measurements in the correponding factor levels defined in `x`.
     In the context of the step 7 above, the limits are added sequentially and then "stitched together" into matrices `A` and `C` (see the code for generating Example 5 for specific cases) 
- `a,b`: parameter values of the CR model needed for computing the locally optimal design
- `crit`: optimality criterion: "D", "A", or "I"
- `type`: defines whether exact or approximate design is computed
- `w0`: size-n vector defining the design to be augmented 

